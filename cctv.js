!function(t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):t.cctv=n()}(this,function(){return function(){var t,n,i,e=function(t,n){for(var i in n)t[i]=n[i];return t},a={viewPoint:{x:0,y:0},angle:0,newAngle:0,translation:{x:62.5,y:92},maxAngle:2.85,minAngle:-.55,init:function(t){this.size=t.size||200,this.color=t.color||"#303030"},draw:function(){this.angle+=(this.newAngle-this.angle)/15,t.beginPath(),t.rect(0,70,10,45),this.roundRect(9,83.75,10,17.5,2),t.rect(18.5,90,37,5),t.arc(this.translation.x,this.translation.y,7.5,0,2*Math.PI),t.save(),t.translate(this.translation.x,this.translation.y),t.rotate(this.angle),t.rect(-2.5,-32.5,5,32.5),this.roundRect(-8.5,-37.5,17.5,6,2),t.rect(-32,-64,80,27.5),t.rect(48,-60,5,15),t.rect(52,-57.25,4,10),t.restore(),t.fillStyle=this.color,t.fill()},update:function(t){t<this.minAngle&&(t=this.minAngle),t>this.maxAngle&&(t=this.maxAngle),this.newAngle=t,this.viewPoint.x=this.translation.x-50*Math.cos(this.angle+90*Math.PI/180),this.viewPoint.y=this.translation.y+parseInt(r.top)-50*Math.sin(this.angle+90*Math.PI/180)},roundRect:function(n,i,e,a,o){var r=n+e,s=i+a;t.moveTo(n+o,i),t.lineTo(r-o,i),t.quadraticCurveTo(r,i,r,i+o),t.lineTo(r,i+a-o),t.quadraticCurveTo(r,s,r-o,s),t.lineTo(n+o,s),t.quadraticCurveTo(n,s,n,s-o),t.lineTo(n,i+o),t.quadraticCurveTo(n,i,n+o,i)}},o={x:window.innerWidth/2,y:window.innerHeight/2},r={color:"#333",top:"75px",size:200};function s(){var t=o.x-a.translation.x,n=o.y-(a.translation.y+parseInt(r.top));Math.sqrt(t*t+n*n)>50&&o.x>20&&function(){var t=a.viewPoint,n=o.y-t.y,i="right"===r.side?Math.abs(o.x-(window.innerWidth-t.x)):o.x-t.x,e=Math.atan2(n,i);a.update(e)}()}function l(){t.clearRect(0,0,n,i),s(),a.draw(),requestAnimationFrame(l)}return{watch:function(s){if(!window.HTMLCanvasElement)return!1;(function(e){var a=document.createElement("canvas"),o=window.devicePixelRatio||1;a.id="cctv-cam",a.style.position="absolute",a.style.top=e.top||0,a.style.right="right"===e.side?0:"auto",a.style.width=a.style.height=(e.size||200)+"px",a.width=n=a.height=i=(e.size||200)*o,t=a.getContext("2d"),"right"===e.side?(t.translate(n,0),t.scale(-o,o)):t.scale(o,o),document.body.appendChild(a)})(r=e(r,s)),a.init(r),document.onmousemove=function(t){o.x=t.pageX||t.clientX,o.y=t.pageY||t.clientY},l()}}}()});
